\chapter{Design of a Policy-based Algorithm for Access to Decentralised Personal Datastores}
\label{chap:matching}

\begin{tcolorbox}[colback=royallavender!40]
The content of this Chapter has already been partially included in the articles published during this Thesis \citep{esteves_odrl_2021,esteves_using_2022,pandit_enhancing_2024}.
\end{tcolorbox}

\begin{tcolorbox}[colback=royallavender!10]
The source code produced during the development of this chapter is stored at:
\begin{itemize}
    \item \url{https://w3id.org/people/besteves/sope/repo}
\end{itemize}
\end{tcolorbox}

This Chapter describes an architecture for a legally-aligned, decentralised personal datastores ecosystem, including the description of a policy matching algorithm and data access agreement generator prototype that uses and extends the developed vocabularies to deal with the specific requirements of health data sharing.
This Chapter builds upon the vocabularies described in Chapter~\ref{chap:vocabularies} to bring decentralised datastore systems, such as Solid, closer to being compliant with data protection law in Europe, by improving its transparency and accountability mechanisms through interoperable, machine-readable information which can be recorded and consulted by data subjects, data controllers and other interested parties.

Section~\ref{sec:architecture} describes a detailed decomposition of the architectural building blocks for a legally-aligned, decentralised personal datastores ecosystem using the C4 graphical notation model \citep{brown_c4_2015}.
System context, container, and component architectural diagrams are provided to report the proposed system, and a sequence diagram is provided to demonstrate how they work together.

% Section~\ref{sec:policies_consent} discusses the usage of OAC policies as a precursor of consent for Solid, which can enable compliance with several GDPR requirements including the transparent information obligations of Articles 13 and 14 and the conditions to obtain valid consent pursuant to Articles 4.11 and 7.
% 
% Section~\ref{sec:automation_consent} argues whether the automation of consent can be performed while maintaining the `informed', `freely given', `specific', and `unambiguous' character of GDPR consent.
% In particular, the specificity of purposes and processing operations, the distinction between data controllers and recipients, the compatibility of purposes, and the delegation of consent are further analysed through a `legal+tech' approach, relying on GDPR's requirements and on the OAC and PLASMA implementations.
% 
% Section~\ref{sec:biomedical_exception} discusses the special requirements of GDPR's special categories of data and research-related exceptions and, in particular, the requirements related to the sharing of health data for biomedical research or for the management of public health.
% 
% To conclude, Section~\ref{sec:ethical_challenges} debates the ethical challenges of controlling data and reclaiming control over it and explores how decentralised PIMS can help build confidence in data exchange practices and trust in the providers and developers of such systems.

\input{mainmatter/6_matching/6-1_architecture}
\input{mainmatter/6_matching/6-2_algorithm}
\input{mainmatter/6_matching/6-3_poc_health}
% \input{mainmatter/5_legal/5-4_biomedical_exception}
% \input{mainmatter/5_legal/5-5_ethical_challenges}

% Design and implementation of a policy matching algorithm and data-sharing agreement generator prototype for access to data stored in Solid Pods.
\chapter{Design of a Policy-based Algorithm for Access to Decentralised Personal Datastores}
\label{chap:matching}

\begin{tcolorbox}[colback=royallavender!40]
The content of this Chapter has already been partially included in the articles published during this Thesis \citep{esteves_odrl_2021,esteves_using_2022,pandit_enhancing_2024,esteves_automating_2022}.
\end{tcolorbox}

\begin{tcolorbox}[colback=royallavender!10]
The source code produced during the development of this chapter is stored at:
\begin{itemize}
    \item \url{https://w3id.org/people/besteves/sope/repo}
    \item \url{https://w3id.org/people/besteves/access-right/api}
    \item \url{https://w3id.org/people/besteves/access-right/solid}
    \item \url{https://w3id.org/duodrl/repo}
\end{itemize}
\end{tcolorbox}

This Chapter describes an architecture for a legally-aligned, decentralised personal data stores ecosystem, including the description of a policy matching algorithm and data access agreement generator prototype that uses and extends the developed vocabularies to deal with the specific requirements of health data sharing.
This Chapter builds upon the vocabularies described in Chapter~\ref{chap:vocabularies} to bring decentralised datastore environments, such as Solid, closer to being compliant with data protection law in Europe, by improving its transparency and accountability mechanisms through interoperable, machine-readable information which can be recorded and consulted by data subjects, data controllers and other interested parties.

Section~\ref{sec:architecture} describes a detailed decomposition of the architectural building blocks for a legally-aligned, decentralised personal datastores ecosystem using the C4 graphical notation model \citep{brown_c4_2015}.
System context, container, and component architectural diagrams are provided to report the proposed system, and a sequence diagram is provided to demonstrate how they work together.

Section~\ref{sec:algorithm} provides a description of the design of algorithms for instantiating user requirements and preferences as user offers and for generating data access agreements, the outcome of matching data requests with user offer policies.
Furthermore, SOPE, an RDF and ODRL-agnostic policy editor to define and store OAC policies in Solid Pods, is described, as well as a REST API service that uses the results of the policy matching algorithm to facilitate the exercising of data subject rights, in particular of the right of access.

Section~\ref{sec:poc_health} discusses the implementation of a proof of concept implementation of the DUO-based algorithms for the specific use case of health datasets shared for research purposes.

To conclude, Section~\ref{sec:evaluation_conclusions} evaluates the developed algorithms and PoC by assessing ontology quality, including pitfall detection and alignment with FAIR principles, and by comparing the proposed policy-based algorithm with DUO's and Solid's existing access control systems.
Concluding remarks concerning the architecture, algorithms, and PoC implementation are also presented.

\input{mainmatter/6_matching/6-1_architecture}
\input{mainmatter/6_matching/6-2_algorithm}
\input{mainmatter/6_matching/6-3_poc_health}
\input{mainmatter/6_matching/6-4_evaluation_conclusions}